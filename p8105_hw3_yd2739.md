p8105_hw3_yd2739
================
Yuxuan Du
2023-10-05

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(p8105.datasets)
```

## Problem 1

``` r
data("instacart")
tidy_instacart = instacart |>
  janitor::clean_names()
```

the size of the dataset is 1384617 x 15

The variables in the data are order_id, product_id, add_to_cart_order,
reordered, user_id, eval_set, order_number, order_dow,
order_hour_of_day, days_since_prior_order, product_name, aisle_id,
department_id, aisle, department

``` r
aisle_number = 
  tidy_instacart|>
  pull(
    aisle_id
  )|>
  unique()|>
  length()

aisle_ordered = tidy_instacart|>
  group_by(aisle)|>
  summarize(n_obs = n())|>
  arrange(desc(n_obs))

head(aisle_ordered)
```

    ## # A tibble: 6 × 2
    ##   aisle                          n_obs
    ##   <chr>                          <int>
    ## 1 fresh vegetables              150609
    ## 2 fresh fruits                  150473
    ## 3 packaged vegetables fruits     78493
    ## 4 yogurt                         55240
    ## 5 packaged cheese                41699
    ## 6 water seltzer sparkling water  36617

There are 134 unique aisle in the dataset, and the most consumed aisle
is fresh vegetables.

``` r
aisle_plot = aisle_ordered|>
  subset(
    n_obs >= 10000
  )|>
  arrange(desc(n_obs))|>
  ggplot(aes(x = reorder(aisle, +n_obs), y = n_obs)) + 
  geom_bar(stat="identity") +
  theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) +
  coord_flip()
        
aisle_plot
```

![](p8105_hw3_yd2739_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

``` r
popular_baking_ingredients_df = tidy_instacart|>
  subset(
    aisle == "baking ingredients"
  )|>
  group_by(product_name)|>
  summarize(n_obs = n())|>
  arrange(desc(n_obs)) |>
  head(3)|>
  mutate(
    category = "baking ingredients"
  )
popular_baking_ingredients_df
```

    ## # A tibble: 3 × 3
    ##   product_name      n_obs category          
    ##   <chr>             <int> <chr>             
    ## 1 Light Brown Sugar   499 baking ingredients
    ## 2 Pure Baking Soda    387 baking ingredients
    ## 3 Cane Sugar          336 baking ingredients

``` r
popular_dog_food_care_df = tidy_instacart|>
  subset(
    aisle == "dog food care"
  )|>
  group_by(product_name)|>
  summarize(n_obs = n())|>
  arrange(desc(n_obs)) |>
  head(3)|>
  mutate(
    category = "dog food care"
  )
popular_dog_food_care_df
```

    ## # A tibble: 3 × 3
    ##   product_name                                  n_obs category     
    ##   <chr>                                         <int> <chr>        
    ## 1 Snack Sticks Chicken & Rice Recipe Dog Treats    30 dog food care
    ## 2 Organix Chicken & Brown Rice Recipe              28 dog food care
    ## 3 Small Dog Biscuits                               26 dog food care

``` r
popular_packaged_vegetables_fruits_df = tidy_instacart|>
  subset(
    aisle == "packaged vegetables fruits"
  )|>
  group_by(product_name)|>
  summarize(n_obs = n())|>
  arrange(desc(n_obs)) |>
  head(3)|>
  mutate(
    category = "packaged vegetables fruits"
  )
popular_packaged_vegetables_fruits_df
```

    ## # A tibble: 3 × 3
    ##   product_name         n_obs category                  
    ##   <chr>                <int> <chr>                     
    ## 1 Organic Baby Spinach  9784 packaged vegetables fruits
    ## 2 Organic Raspberries   5546 packaged vegetables fruits
    ## 3 Organic Blueberries   4966 packaged vegetables fruits

``` r
three_items_merged = bind_rows(
  popular_baking_ingredients_df, 
  popular_dog_food_care_df, 
  popular_packaged_vegetables_fruits_df)|>
  arrange(desc(n_obs))
  
three_items_merged
```

    ## # A tibble: 9 × 3
    ##   product_name                                  n_obs category                  
    ##   <chr>                                         <int> <chr>                     
    ## 1 Organic Baby Spinach                           9784 packaged vegetables fruits
    ## 2 Organic Raspberries                            5546 packaged vegetables fruits
    ## 3 Organic Blueberries                            4966 packaged vegetables fruits
    ## 4 Light Brown Sugar                               499 baking ingredients        
    ## 5 Pure Baking Soda                                387 baking ingredients        
    ## 6 Cane Sugar                                      336 baking ingredients        
    ## 7 Snack Sticks Chicken & Rice Recipe Dog Treats    30 dog food care             
    ## 8 Organix Chicken & Brown Rice Recipe              28 dog food care             
    ## 9 Small Dog Biscuits                               26 dog food care

``` r
apples_coffee_df = tidy_instacart|>
  subset(
    product_name == "Pink Lady Apples" | product_name == "Coffee Ice Cream"
  )|>
  group_by(order_dow)|>
  summarize(
    mean_hour = mean(order_hour_of_day, na.rm = TRUE)
  )|>
  mutate(
    order_dow = case_match(
      order_dow, 
      0 ~ "Sunday", 
      1 ~ "Monday", 
      2 ~ "Tuesday", 
      3 ~ "Wednesday", 
      4 ~ "Thursday", 
      5 ~ "Friday", 
      6 ~ "Saturday"
    )
  )

apples_coffee_df
```

    ## # A tibble: 7 × 2
    ##   order_dow mean_hour
    ##   <chr>         <dbl>
    ## 1 Sunday         13.6
    ## 2 Monday         12.2
    ## 3 Tuesday        12.8
    ## 4 Wednesday      14.7
    ## 5 Thursday       13.2
    ## 6 Friday         12.6
    ## 7 Saturday       13.2
